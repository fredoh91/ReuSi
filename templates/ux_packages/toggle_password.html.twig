{# templates/ux_packages/toggle_password.html.twig #}

{% block body %}
    {% if form is defined %}
        {{ form_start(form, {
            'method': 'post',
            'action': path('app_login'),
            'attr': {
                'novalidate': 'novalidate'
            }
        }) }}
        
            {% if error %}
                <div class="alert alert-danger">
                    {{ error.messageKey|trans(error.messageData, 'security') }}
                </div>
            {% endif %}
            
            <h1 class="h3 mb-3 font-weight-normal">Merci de vous connecter</h1>
           
            {{ form_row(form._username, {
                'label': 'Email',
                'label_attr': {'for': 'inputEmail'}
            }) }}
           
            {# --- Début de la nouvelle structure pour le champ mot de passe --- #}
            <div class="mb-3" {{ stimulus_controller('toggle-password') }}>
                {{ form_label(form._password) }}
                <div class="input-group">
                    {{ form_widget(form._password, {
                        attr: { 'data-toggle-password-target': 'input' }
                    }) }}
                    <button class="btn btn-outline-secondary" type="button" data-action="toggle-password#toggle">
                        {# Assurez-vous d'avoir bootstrap-icons ou remplacez par du texte/autre icône #}
                        <i class="bi bi-eye-slash" data-toggle-password-target="iconShow"></i>
                        <i class="bi bi-eye" data-toggle-password-target="iconHide"></i>
                    </button>
                </div>
                {{ form_errors(form._password) }}
            </div>
            {# --- Fin de la nouvelle structure --- #}
            
            {{ form_row(form._remember_me) }}
            
            {# Token CSRF manuel #}
            <input type="hidden" name="_token" value="{{ csrf_token('authenticate') }}">
            
            {{ form_widget(form.submit) }}
            
        {{ form_end(form, {'render_rest': false}) }}
    {% endif %}
{% endblock %}